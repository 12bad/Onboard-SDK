<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8" />

	<!--
		<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" />

		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>

		<script type="text/javascript" src="http://cdn.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
		<script type="text/javascript" src="http://cdn.robotwebtools.org/roslibjs/current/roslib.min.js"></script>
		<script type="text/javascript" src="http://cdn.robotwebtools.org/keyboardteleopjs/current/keyboardteleop.min.js"></script>
		-->
	<link rel="stylesheet" type="text/css" href="jquery-ui.css" />

	<script type="text/javascript" src="jquery.min.js"></script>
	<script type="text/javascript" src="jquery-ui.min.js"></script>

	<script type="text/javascript" src="eventemitter2.min.js"></script>
	<script type="text/javascript" src="roslib.min.js"></script>
	<script type="text/javascript" src="keyboardteleop.js"></script>


	<script type="text/javascript">
	  /**
	  * Setup all GUI elements when the page is loaded.
	  */
	  function init() {
	  // Connecting to ROS.
	  var ros = new ROSLIB.Ros({
	  url : 'ws://192.168.2.104:9090'
	  });

	  // Initialize the teleop.
	  var teleop = new KEYBOARDTELEOP.Teleop({
	  ros : ros,
	  topic : '/board_ctrl'
	  });

      // listen to status
	  var flight_status_listener = new ROSLIB.Topic({
	  ros : ros,
	  name : '/uav_flight_status',
	  messageType : 'std_msgs/Float32'
	  });
      var status_display = document.getElementById('status-view');
      var status_list = new Array('unknown', 'standby','takingoff','in the air','landing','post landing');

	  while( status_display.firstChild ) {
	  status_display.removeChild( status_display.firstChild );
	  }
	  status_display.appendChild( document.createTextNode(status_list[0]) );
	  // Then we add a callback to be called every time a message is published on this topic.
	  flight_status_listener.subscribe(function(message) {
	  console.log('Received message on ' + flight_status_listener.name + ': ' + message.data);
	  while( status_display.firstChild ) {
	  status_display.removeChild( status_display.firstChild );
	  }
	  status_display.appendChild( document.createTextNode(status_list[message.data]) );

	  });

	  }
	</script>
  </head>

  <body onload="init()">

	<div>
   	  <div>
		<h3>UAV Control Interface</h3>
		<div>
		  <h4>Flight Status Display &amp; Control</h4>	
		  <div>Current status is: <span id="status-view"></span></div>
		  <div>I request status:  <span id="status-request"></span></div>
		  <div><button id="takeoff-button">Take Off</button> </div>
		  <div><button id="landing-button">Landing</button> </div>
		</div>

		<div>
		  <h4>Task Status Display &amp; Control</h4>
		  <div>Speed level: <span id="speed-level">0</span></div>
		</div>
	  </div>
	</div>
  </body>
</html>
